import{u as A,o as B,c as v,w as i,a as e,I as M,t as N,b as O,d as c,e as n,f as R,g as t,h as T,i as f,j as x,n as h,k as I,l as w,m as _,p as y,q as k,r as D,s as C,v as q,x as F,y as g,z as P}from"./index-vCZlUi6s.js";import{v as j}from"./validators-nUUIucrN.js";import{u as z}from"./useOfflineStorage-B5XdQuUJ.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H="/assets/images/logo.svg",$={class:"login-container"},G={class:"input-group"},J={class:"input-group"},K={key:1},Q={key:2},W={class:"status-container"},X={__name:"LoginScreen",setup(Y){const V=O(),b=A(),{isOnline:u}=z(),l=g({email:"",password:"",rememberMe:!1}),m=g(!1),o=g({}),d=g(!1),E=P(()=>l.value.email&&l.value.password&&Object.keys(o.value).length===0),S=()=>{const r=j(l.value);return o.value=r.errors,r.isValid},L=async()=>{if(!u.value){await p("Connexion Internet requise pour se connecter","danger");return}if(!S())return;d.value=!0,o.value={};const r=await F.create({message:"Connexion en cours...",spinner:"crescent"});try{if(await r.present(),await new Promise(s=>setTimeout(s,2e3)),(await b.login(l.value.email,l.value.password)).success)await p("Connexion rÃ©ussie !","success"),await V.push("/map");else throw new Error("Erreur lors de la connexion")}catch(a){console.error("Erreur de connexion:",a);const s=a.message||"Erreur lors de la connexion";await p(s,"danger"),s.includes("email")?o.value.email=s:s.includes("mot de passe")&&(o.value.password=s)}finally{d.value=!1,await r.dismiss()}},p=async(r,a="primary")=>{await(await N.create({message:r,duration:3e3,color:a,position:"top"})).present()};return B(async()=>{u.value||await p("Connexion Internet requise","warning")}),(r,a)=>(c(),v(e(M),null,{default:i(()=>[n(e(R),{fullscreen:!0,class:"login-content"},{default:i(()=>[t("div",$,[a[3]||(a[3]=t("div",{class:"logo-section"},[t("div",{class:"logo-circle"},[t("img",{src:H,alt:"ROAD ALERT",class:"logo-image"})]),t("h1",{class:"app-title"},"ROAD ALERT"),t("p",{class:"app-subtitle"},"Antananarivo"),t("div",{class:"decoration-line"})],-1)),t("form",{onSubmit:T(L,["prevent"]),class:"login-form"},[t("div",G,[n(e(f),{name:"mail-outline",class:"input-icon"}),n(e(x),{modelValue:l.value.email,"onUpdate:modelValue":a[0]||(a[0]=s=>l.value.email=s),type:"email",placeholder:"Email",class:h(["custom-input",{"input-error":o.value.email}])},null,8,["modelValue","class"])]),o.value.email?(c(),v(e(I),{key:0,class:"error-note"},{default:i(()=>[w(_(o.value.email),1)]),_:1})):y("",!0),t("div",J,[n(e(f),{name:"lock-closed-outline",class:"input-icon"}),n(e(x),{modelValue:l.value.password,"onUpdate:modelValue":a[1]||(a[1]=s=>l.value.password=s),type:m.value?"text":"password",placeholder:"Mot de passe",class:h(["custom-input",{"input-error":o.value.password}])},null,8,["modelValue","type","class"]),n(e(k),{fill:"clear",onClick:a[2]||(a[2]=s=>m.value=!m.value),class:"password-toggle"},{default:i(()=>[n(e(f),{name:m.value?"eye-off-outline":"eye-outline"},null,8,["name"])]),_:1})]),o.value.password?(c(),v(e(I),{key:1,class:"error-note"},{default:i(()=>[w(_(o.value.password),1)]),_:1})):y("",!0),n(e(k),{expand:"block",type:"submit",disabled:!E.value||d.value||!e(u),class:"login-button"},{default:i(()=>[d.value?(c(),v(e(D),{key:0,slot:"start",name:"crescent"})):y("",!0),d.value?(c(),C("span",K,"Connexion...")):(c(),C("span",Q,"Se connecter"))]),_:1},8,["disabled"])],32),t("div",W,[n(e(q),{color:e(u)?"success":"warning",class:"status-badge"},{default:i(()=>[n(e(f),{name:e(u)?"wifi":"cloud-offline-outline"},null,8,["name"]),w(" "+_(e(u)?"En ligne":"Hors ligne"),1)]),_:1},8,["color"])])])]),_:1})]),_:1}))}},oe=U(X,[["__scopeId","data-v-d34ea0d6"]]);export{oe as default};
