import{u as K,o as Q,c,w as n,a,I as W,b as X,d as i,e as o,f as Y,g as r,i as k,A as M,s as f,F as Z,B as ee,n as w,m as g,h as se,C as I,D as _,l as m,j as T,k as C,p as d,q as N,E as ae,r as le,z as y,y as V,x as te,t as oe}from"./index-vCZlUi6s.js";import{a as U,b as re,c as ne,d as ie,g as ue}from"./validators-nUUIucrN.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const me={class:"register-container"},ce={class:"logo-section"},ve={class:"progress-section"},pe={class:"progress-bar"},fe={class:"step-indicators"},we={key:1},ge={class:"step-text"},ye={key:0,class:"step-content"},ke={key:1,class:"step-content"},Ve={key:0,class:"password-strength"},be={class:"strength-bar"},Pe={class:"strength-text"},Ie={key:2,class:"step-content"},_e={class:"terms-section"},Ce={class:"form-actions"},Ne={key:1},Se={key:2},xe={__name:"RegisterScreen",setup(Te){const R=X(),L=K(),u=V(1),p=V(!1),S=V(!1),x=V(!1),s=V({fullName:"",email:"",password:"",confirmPassword:"",acceptTerms:!1}),t=V({}),j=y(()=>u.value/3*100),q=y(()=>({1:"Informations personnelles",2:"Sécurité du compte",3:"Validation des conditions"})[u.value]),b=y(()=>s.value.password?ue(s.value.password):0),A=y(()=>b.value<40?"weak":b.value<70?"medium":"strong"),G=y(()=>b.value<40?"Faible":b.value<70?"Moyen":"Fort"),E=y(()=>{switch(u.value){case 1:return s.value.fullName&&s.value.email&&!t.value.fullName&&!t.value.email;case 2:return s.value.password&&s.value.confirmPassword&&!t.value.password&&!t.value.confirmPassword;case 3:return s.value.acceptTerms&&!t.value.acceptTerms;default:return!1}}),$=y(()=>s.value.fullName&&s.value.email&&s.value.password&&s.value.confirmPassword&&s.value.acceptTerms&&Object.keys(t.value).length===0),P=v=>{const e={};switch(v){case"fullName":const l=ie(s.value.fullName);l.isValid||(e.fullName=l.message);break;case"email":const z=ne(s.value.email);z.isValid||(e.email=z.message);break;case"password":const D=re(s.value.password);if(D.isValid||(e.password=D.message),s.value.confirmPassword){const B=U(s.value.password,s.value.confirmPassword);B.isValid||(e.confirmPassword=B.message)}break;case"confirmPassword":const F=U(s.value.password,s.value.confirmPassword);F.isValid||(e.confirmPassword=F.message);break;case"acceptTerms":s.value.acceptTerms||(e.acceptTerms="Vous devez accepter les conditions d'utilisation");break}t.value={...t.value,...e},e[v]===void 0&&delete t.value[v]},J=()=>{E.value&&u.value<3&&u.value++},O=()=>{u.value>1&&u.value--},H=async()=>{if(!$.value)return;p.value=!0;const v=await te.create({message:"Création du compte...",spinner:"crescent"});try{if(await v.present(),await new Promise(l=>setTimeout(l,2e3)),(await L.register({fullName:s.value.fullName,email:s.value.email,password:s.value.password,confirmPassword:s.value.confirmPassword})).success)await h("Compte créé avec succès !","success"),await R.push("/map");else throw new Error("Erreur lors de la création du compte")}catch(e){console.error("Erreur d'inscription:",e);const l=e.message||"Erreur lors de la création du compte";await h(l,"danger")}finally{p.value=!1,await v.dismiss()}},h=async(v,e="primary")=>{await(await oe.create({message:v,duration:3e3,color:e,position:"top"})).present()};return Q(()=>{}),(v,e)=>(i(),c(a(W),null,{default:n(()=>[o(a(Y),{fullscreen:!0,class:"register-content-modern"},{default:n(()=>[r("div",me,[r("div",ce,[o(a(k),{name:"person-add-outline",size:"large",color:"primary"}),e[12]||(e[12]=r("h2",null,"Créer un compte",-1))]),r("div",ve,[r("div",pe,[r("div",{class:"progress-fill",style:M({width:`${j.value}%`})},null,4)]),r("div",fe,[(i(),f(Z,null,ee(3,l=>r("div",{key:l,class:w(["step-indicator",{active:u.value>=l,completed:u.value>l}])},[u.value>l?(i(),c(a(k),{key:0,name:"checkmark",size:"small"})):(i(),f("span",we,g(l),1))],2)),64))]),r("p",ge,g(q.value),1)]),r("form",{onSubmit:se(H,["prevent"]),class:"register-form"},[u.value===1?(i(),f("div",ye,[o(a(I),{class:"form-item"},{default:n(()=>[o(a(_),{position:"floating"},{default:n(()=>[...e[13]||(e[13]=[m("Nom complet *",-1)])]),_:1}),o(a(T),{modelValue:s.value.fullName,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.fullName=l),placeholder:"Votre nom complet",onIonInput:e[1]||(e[1]=l=>P("fullName")),class:w({"ion-invalid":t.value.fullName})},null,8,["modelValue","class"]),t.value.fullName?(i(),c(a(C),{key:0,slot:"error",color:"danger"},{default:n(()=>[m(g(t.value.fullName),1)]),_:1})):d("",!0)]),_:1}),o(a(I),{class:"form-item"},{default:n(()=>[o(a(_),{position:"floating"},{default:n(()=>[...e[14]||(e[14]=[m("Email *",-1)])]),_:1}),o(a(T),{modelValue:s.value.email,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.email=l),type:"email",placeholder:"votre.email@example.com",onIonInput:e[3]||(e[3]=l=>P("email")),class:w({"ion-invalid":t.value.email})},null,8,["modelValue","class"]),t.value.email?(i(),c(a(C),{key:0,slot:"error",color:"danger"},{default:n(()=>[m(g(t.value.email),1)]),_:1})):d("",!0)]),_:1})])):d("",!0),u.value===2?(i(),f("div",ke,[o(a(I),{class:"form-item"},{default:n(()=>[o(a(_),{position:"floating"},{default:n(()=>[...e[15]||(e[15]=[m("Mot de passe *",-1)])]),_:1}),o(a(T),{modelValue:s.value.password,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.password=l),type:S.value?"text":"password",placeholder:"Minimum 8 caractères",onIonInput:e[5]||(e[5]=l=>P("password")),class:w({"ion-invalid":t.value.password})},null,8,["modelValue","type","class"]),o(a(N),{fill:"clear",slot:"end",onClick:e[6]||(e[6]=l=>S.value=!S.value),class:"password-toggle"},{default:n(()=>[o(a(k),{name:S.value?"eye-off":"eye",color:"medium"},null,8,["name"])]),_:1}),t.value.password?(i(),c(a(C),{key:0,slot:"error",color:"danger"},{default:n(()=>[m(g(t.value.password),1)]),_:1})):d("",!0)]),_:1}),s.value.password?(i(),f("div",Ve,[r("div",be,[r("div",{class:w(["strength-fill",A.value]),style:M({width:`${b.value}%`})},null,6)]),r("span",Pe,g(G.value),1)])):d("",!0),o(a(I),{class:"form-item"},{default:n(()=>[o(a(_),{position:"floating"},{default:n(()=>[...e[16]||(e[16]=[m("Confirmer le mot de passe *",-1)])]),_:1}),o(a(T),{modelValue:s.value.confirmPassword,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.confirmPassword=l),type:x.value?"text":"password",placeholder:"Répétez votre mot de passe",onIonInput:e[8]||(e[8]=l=>P("confirmPassword")),class:w({"ion-invalid":t.value.confirmPassword})},null,8,["modelValue","type","class"]),o(a(N),{fill:"clear",slot:"end",onClick:e[9]||(e[9]=l=>x.value=!x.value),class:"password-toggle"},{default:n(()=>[o(a(k),{name:x.value?"eye-off":"eye",color:"medium"},null,8,["name"])]),_:1}),t.value.confirmPassword?(i(),c(a(C),{key:0,slot:"error",color:"danger"},{default:n(()=>[m(g(t.value.confirmPassword),1)]),_:1})):d("",!0)]),_:1})])):d("",!0),u.value===3?(i(),f("div",Ie,[r("div",_e,[e[18]||(e[18]=r("h3",null,"Conditions d'utilisation",-1)),e[19]||(e[19]=r("div",{class:"terms-content"},[r("p",null,"En créant un compte, vous acceptez :"),r("ul",null,[r("li",null,"De fournir des informations exactes"),r("li",null,"D'utiliser l'application de manière responsable"),r("li",null,"De respecter les autres utilisateurs"),r("li",null,"De signaler uniquement des problèmes réels")])],-1)),o(a(I),{lines:"none",class:"terms-item"},{default:n(()=>[o(a(ae),{modelValue:s.value.acceptTerms,"onUpdate:modelValue":e[10]||(e[10]=l=>s.value.acceptTerms=l),slot:"start",onIonChange:e[11]||(e[11]=l=>P("acceptTerms")),class:w({"ion-invalid":t.value.acceptTerms})},null,8,["modelValue","class"]),o(a(_),{class:"terms-label"},{default:n(()=>[...e[17]||(e[17]=[m(" J'accepte les conditions d'utilisation * ",-1)])]),_:1})]),_:1}),t.value.acceptTerms?(i(),c(a(C),{key:0,color:"danger"},{default:n(()=>[m(g(t.value.acceptTerms),1)]),_:1})):d("",!0)])])):d("",!0),r("div",Ce,[u.value>1?(i(),c(a(N),{key:0,fill:"outline",onClick:O,disabled:p.value,class:"nav-button"},{default:n(()=>[o(a(k),{name:"arrow-back",slot:"start"}),e[20]||(e[20]=m(" Précédent ",-1))]),_:1},8,["disabled"])):d("",!0),u.value<3?(i(),c(a(N),{key:1,onClick:J,disabled:!E.value||p.value,class:"nav-button primary"},{default:n(()=>[e[21]||(e[21]=m(" Suivant ",-1)),o(a(k),{name:"arrow-forward",slot:"end"})]),_:1},8,["disabled"])):d("",!0),u.value===3?(i(),c(a(N),{key:2,type:"submit",expand:"block",disabled:!$.value||p.value,class:w(["submit-button",{"button-loading":p.value}])},{default:n(()=>[p.value?(i(),c(a(le),{key:0,slot:"start",name:"crescent"})):d("",!0),p.value?(i(),f("span",Ne,"Création du compte...")):(i(),f("span",Se,"Créer mon compte"))]),_:1},8,["disabled","class"])):d("",!0)])],32)])]),_:1})]),_:1}))}},ze=de(xe,[["__scopeId","data-v-936e1c21"]]);export{ze as default};
